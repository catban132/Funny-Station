- type: entity
  id: RitualSacrifice
  name: Sacrifice
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: Mobs/Species/Human/organs.rsi
    state: heart-on
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Targets
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
      - !type:ConditionsRitualCondition
        requireAll: false
        conditions:
        - !type:IsTargetCondition
        - !type:WhitelistCondition
          checkMind: true
          whitelist:
            components:
            - Heretic
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Targets
        min: 1
        cancelLoc: heretic-ritual-fail-sacrifice-ineligible
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticUpdateTargets

- type: entity
  id: RitualAmberFocus
  name: Amber Focus
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/amber_focus.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - SheetGlass
          name: heretic-ritual-ingredient-glass-sheet
        - whitelist:
            components:
            - Eyes
          name: heretic-ritual-ingredient-eyes
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        ClothingNeckAmberFocus: 1

- type: entity
  id: RitualLivingHeart
  name: Relentless Heartbeat
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/items.rsi
    state: living_heart
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Paper
          name: heretic-ritual-ingredient-paper
        - whitelist:
            tags:
            - Pen
          name: heretic-ritual-ingredient-pen
        - whitelist:
            components:
            - Heart
          name: heretic-ritual-ingredient-heart
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticRerollTargets

- type: entity
  id: RitualCodexCicatrix
  name: Codex Cicatrix
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/book.rsi
    state: icon-on
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Meat
          name: heretic-ritual-ingredient-meat
        - whitelist:
            tags:
            - Pen
          name: heretic-ritual-ingredient-pen
        - whitelist:
            tags:
            - Book
          name: heretic-ritual-ingredient-book
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        CodexCicatrix: 1

- type: entity
  id: RitualFeastOfOwls
  name: Feast of Owls
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/abilities_heretic.rsi
    state: god_transmit
  - type: HereticRitual
    playSuccessAnimation: false
    effects:
    - !type:OpenRuneBuiEffect
      applyOn: Performer
      key: enum.FeastOfOwlsUiKey.Key
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
  - type: Tag
    tags:
    - RitualFeastOfOwls

### ash path
- type: entity
  id: RitualBladeAsh
  name: Nightwatcher's Secret
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_ash.rsi
    state: icon
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
        - whitelist:
            tags:
            - Matchstick
          name: heretic-ritual-ingredient-matchstick
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeAsh: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 3

- type: entity
  id: RitualMaskOfMadness
  name: Mask of Madness
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/mad_mask.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            components:
            - Mask
          name: heretic-ritual-ingredient-mask
        - whitelist:
            tags:
            - Flare
          name: heretic-ritual-ingredient-flare
        - whitelist:
            tags:
            - Lighter
          name: heretic-ritual-ingredient-lighter
        - whitelist:
            tags:
            - Ash
          name: heretic-ritual-ingredient-ash
        - whitelist:
            components:
            - Stunbaton
          name: heretic-ritual-ingredient-stun-baton
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        ClothingMaskMadHeretic: 1

- type: entity
  id: RitualAscensionAsh
  name: Ashlord's Rite
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/abilities_heretic.rsi
    state: ashlord_rite2
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
      - !type:OnFireCondition
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 3
        max: 3
        cancelLoc: heretic-ritual-fail-sacrifice-ash
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: AshlordRite
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
  - type: Tag
    tags:
    - RitualAscension

### blade path
- type: entity
  id: RitualBladeBlade
  name: Cutting Edge
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_blade.rsi
    state: icon
  - type: HereticRitual
    limit: 4
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
          amount: 2
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeBlade: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 3
  - type: Tag
    tags:
    - RitualBladeBlade

- type: entity
  id: RitualAscensionBlade
  name: Maelstrom of Silver
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/items.rsi
    state: protective_blade
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
      - !type:HasBodyPartCondition
        part: Head
        inverted: true
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 3
        max: 3
        cancelLoc: heretic-ritual-fail-sacrifice-blade
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: MaelstromOfSilver
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
  - type: Tag
    tags:
    - RitualAscension

### flesh path
- type: entity
  id: RitualBladeFlesh
  name: Principle of Hunger
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_flesh.rsi
    state: icon
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Puddles
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - Puddle
      - !type:ReagentsCondition
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:InputCountCondition
        applyOn: Puddles
        result: Delete2
        min: 1
        cancelLoc: heretic-ritual-fail-reagent-blood
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:EffectsRitualEffect
      applyOn: Delete2
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeFlesh: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 5

- type: entity
  id: RitualImperfect
  name: Imperfect Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: Mobs/Species/Skeleton/parts.rsi
    state: full
  - type: HereticRitual
    limit: 2
    cancelLoc: heretic-ritual-fail-ghoulify
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:AddToLimitRitualEffect
      applyOn: Look
      result: Targets
      individualConditions:
      - !type:WhitelistCondition
        blacklist:
          components:
          - Ghoul
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Muzzle
          name: heretic-ritual-ingredient-muzzle
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:InputCountCondition
        applyOn: Targets
        result: Result
        min: 1
        cancelLoc: heretic-ritual-fail-ghoulify
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:GhoulifyEffect
      applyOn: Result
    - !type:EffectsRitualEffect
      applyOn: Result
      effects:
      - !type:AddComponents
        components:
        - type: Muted
        - type: HereticBladeUserBonusDamage

- type: entity
  id: RitualRaw
  name: Raw Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/eldritch_mobs.rsi
    state: raw_prophet
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Puddles
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - Puddle
      - !type:ReagentsCondition
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:InputCountCondition
        applyOn: Puddles
        result: Delete2
        min: 1
        cancelLoc: heretic-ritual-fail-reagent-blood
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            components:
            - Eyes
          name: heretic-ritual-ingredient-eyes
        - whitelist:
            components:
            - Stomach
          name: heretic-ritual-ingredient-stomach
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:EffectsRitualEffect
      applyOn: Delete2
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        MobGhoulProphet: 1

- type: entity
  id: RitualLonely
  name: Lonely Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/eldritch_mobs.rsi
    state: stalker
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Puddles
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - Puddle
      - !type:ReagentsCondition
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:InputCountCondition
        applyOn: Puddles
        result: Delete2
        min: 1
        cancelLoc: heretic-ritual-fail-reagent-blood
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Pen
          name: heretic-ritual-ingredient-pen
        - whitelist:
            components:
            - Heart
          name: heretic-ritual-ingredient-heart
        - whitelist:
            components:
            - Stomach
          name: heretic-ritual-ingredient-stomach
        - whitelist:
            components:
            - Lung
          name: heretic-ritual-ingredient-lung
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:EffectsRitualEffect
      applyOn: Delete2
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        MobGhoulProphet: 1

- type: entity
  id: RitualAscensionFlesh
  name: Priestâ€™s Final Hymn
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/abilities_heretic.rsi
    state: final_hymn
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 4
        max: 4
        cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: PriestFinalHymn
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
  - type: Tag
    tags:
    - RitualAscension

### void path
- type: entity
  id: RitualBladeVoid
  name: Glimmer of Winter
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_void.rsi
    state: icon
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ConditionsRitualCondition
        applyOn: Platform
        conditions:
        - !type:EnvironmentTemperatureCondition
        cancelLoc: heretic-ritual-fail-temperature-hot
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeVoid: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 3

- type: entity
  id: RitualAscensionVoid
  name: Waltz at the End of Time
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: Interface/Alerts/temperature.rsi
    state: cold3
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
      - !type:ConditionsRitualCondition
        applyOn: Platform
        conditions:
        - !type:EnvironmentTemperatureCondition
        cancelLoc: heretic-ritual-fail-temperature-hot
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 3
        max: 3
        cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: WaltzAtTheEndOfTime
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
  - type: Tag
    tags:
    - RitualAscension

### rust path
- type: entity
  id: RitualBladeRust
  name: Blacksmith's Tale
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_rust.rsi
    state: icon
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
        - whitelist:
            tags:
            - Trash
          name: heretic-ritual-ingredient-trash
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeRust: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 3

- type: entity
  id: RitualAscensionRust
  name: Rustbringer's Oath
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/abilities_heretic.rsi
    state: ascension_rust
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - HumanoidAppearance
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
      - !type:WhitelistCondition
        whitelist:
          components:
          - Rotting
          - Silicon
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 3
        max: 3
        cancelLoc: heretic-ritual-fail-sacrifice-rust
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: RustbringersOath
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticRustAscensionSpreader: 1
  - type: Tag
    tags:
    - RitualAscension

### cosmic path
- type: entity
  id: RitualBladeCosmos
  name: Eternal Gate
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Blades/blade_cosmos.rsi
    state: icon
  - type: HereticRitual
    limit: 2
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
        - whitelist:
            tags:
            - SheetGlass
          name: heretic-ritual-ingredient-glass-sheet
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticBladeCosmos: 1
    limitReachedEffects:
    - !type:FindLostLimitedOutputEffect
      applyOn: Platform
      result: Lost
      minRange: 3.5
    - !type:TeleportToRuneEffect
      applyOn: Result
      conditions:
      - !type:InputCountCondition
        applyOn: Lost
        result: Result
        min: 1
        max: 1
        cancelLoc: heretic-ritual-fail-no-lost-blades
      - !type:TryApplyEffectSequenceCondition
        from: 0
        to: 3


- type: entity
  id: RitualAscensionCosmos
  name: Creators's Gift
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/abilities_heretic.rsi
    state: stargazer
  - type: HereticRitual
    cancelLoc: heretic-ritual-fail-sacrifice-not-enough
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
      conditions:
      - !type:CanAscendCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend
      - !type:ObjectivesCompleteCondition
        applyOn: Mind
        cancelLoc: heretic-ritual-fail-cannot-ascend-objectives
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Eligible
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          requireAll: true
          components:
          - HumanoidAppearance
          - StarMark
      - !type:MobStateCondition
        mobstate: Alive
        inverted: true
    - !type:SacrificeEffect
      applyOn: Targets
      conditions:
      - !type:InputCountCondition
        applyOn: Eligible
        result: Targets
        min: 3
        max: 3
        cancelLoc: heretic-ritual-fail-sacrifice-cosmos
    - !type:AddKnowledgeEffect
      applyOn: Mind
      knowledge: CreatorsGift
    - !type:EffectsRitualEffect
      applyOn: Mind
      effects:
      - !type:RaiseEvents
        events:
        - !type:EventHereticAscension
        - !type:EventHereticUpdateTargets
        - !type:EventHereticResolveStarGazer
  - type: Tag
    tags:
    - RitualAscension

### side knowledge
- type: entity
  id: RitualKnowledge
  name: Ritual of Knowledge
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/book.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
      conditions:
      - !type:FilterKnowledgeTagsCondition
        applyOn: Look
        result: Delete
    - !type:RemoveRitualsEffect
      applyOn: Mind
      ritualTags:
      - RitualKnowledge
    - !type:UpdateKnowledgeEffect
      applyOn: Mind
      amount: 5
  - type: HereticKnowledgeRitual
  - type: Tag
    tags:
    - RitualKnowledge

## stage 3
- type: entity
  id: RitualArmorer
  name: Armorer's Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Clothing/OuterClothing/eldritch_armor.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Table
          name: heretic-ritual-ingredient-table
        - whitelist:
            tags:
            - GasMask
          name: heretic-ritual-ingredient-gas-mask
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:PathBasedSpawnEffect
      applyOn: Platform
      fallbackOutput: ClothingOuterArmorHeretic
      output:
        Ash: ClothingOuterArmorHereticAsh
        Void: ClothingOuterArmorHereticVoid
        Flesh: ClothingOuterArmorHereticFlesh
        Blade: ClothingOuterArmorHereticBlade
        Cosmos: ClothingOuterArmorHereticCosmos
        Rust: ClothingOuterArmorHeretic

- type: entity
  id: RitualPriest
  name: Priest's Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/items.rsi
    state: eldritch_flask
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - WaterTank
          name: heretic-ritual-ingredient-water-tank
        - whitelist:
            tags:
            - GlassShard
          name: heretic-ritual-ingredient-glass-shard
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        HereticEldritchFlask: 1

- type: entity
  id: RitualAshenEyes
  name: Ashen Eyes
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/eldritch_medalion.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - GlassShard
          name: heretic-ritual-ingredient-glass-shard
        - whitelist:
            components:
            - Eyes
          name: heretic-ritual-ingredient-eyes
        - whitelist:
            tags:
            - Flare
          name: heretic-ritual-ingredient-flare
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        ClothingEldritchMedalion: 1

- type: entity
  id: RitualVoidCloak
  name: Void Cloak
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/Clothing/OuterClothing/void_cloak.rsi
    state: icon
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - GlassShard
          name: heretic-ritual-ingredient-glass-shard
        - whitelist:
            tags:
            - Bedsheet
          name: heretic-ritual-ingredient-bedsheet
        - whitelist:
            tags:
            - WinterCoat
          name: heretic-ritual-ingredient-winter-coat
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        ClothingOuterArmorCloakVoid: 1

- type: entity
  id: RitualScorchingShark
  name: Scorching Shark
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/eldritch_mobs.rsi
    state: fire_shark_icon
  - type: HereticRitual
    limit: 15
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Ash
          name: heretic-ritual-ingredient-ash
          amount: 3
        - whitelist:
            components:
            - Liver
          name: heretic-ritual-ingredient-liver
        - whitelist:
            tags:
            - SheetPlasma
          name: heretic-ritual-ingredient-plasma-sheet
          amount: 3
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        MobGhoulFireShark: 3

## stage 6
- type: entity
  id: RitualRusted
  name: Rusted Ritual
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/eldritch_mobs.rsi
    state: rust_walker
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SaveResultRitualEffect
      applyOn: Look
      result: Puddles
      individualConditions:
      - !type:WhitelistCondition
        whitelist:
          components:
          - Puddle
      - !type:ReagentsCondition
        reagents:
        - Vomit
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:InputCountCondition
        applyOn: Puddles
        result: Delete2
        min: 1
        cancelLoc: heretic-ritual-fail-reagent-vomit
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - Steel
          name: heretic-ritual-ingredient-steel
          amount: 10
        - whitelist:
            tags:
            - CableCoil
          name: heretic-ritual-ingredient-cable-coil
          amount: 15
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:EffectsRitualEffect
      applyOn: Delete2
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        MobGhoulRustWalker: 1

- type: entity
  id: RitualCarvingKnife
  name: CarvingKnife
  categories: [ HideSpawnMenu ]
  components:
  - type: Icon
    sprite: _Goobstation/Heretic/items.rsi
    state: rune_carver
  - type: HereticRitual
    effects:
    - !type:LookupRitualEffect
      applyOn: Platform
      result: Look
    - !type:SplitIngredientsRitualEffect
      applyOn: Split
      conditions:
      - !type:ProcessIngredientsCondition
        applyOn: Look
        deleteEntitiesKey: Delete
        splitEntitiesKey: Split
        ingredients:
        - whitelist:
            tags:
            - GlassShard
          name: heretic-ritual-ingredient-glass-shard
        - whitelist:
            tags:
            - Paper
          name: heretic-ritual-ingredient-paper
        - whitelist:
            tags:
            - Knife
          name: heretic-ritual-ingredient-knife
    - !type:EffectsRitualEffect
      applyOn: Delete
      effects:
      - !type:Delete
    - !type:SpawnRitualEffect
      applyOn: Platform
      output:
        CarvingKnife: 1
